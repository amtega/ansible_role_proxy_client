---
# Role dependencies

galaxy_info:
  role_name: proxy_client
  author: Juan Antonio Valiño García
  description: Setup proxy client environment variables
  company: AMTEGA - Xunta de Galicia
  license: GPLv3 or EUPL
  min_ansible_version: 2.7
  platforms:
  - name: EL
    versions:
      - 6
      - 7
  - name: Fedora
    versions:
      - 27
      - 28
  galaxy_tags:
    - system
    - http
    - proxy
    - client

dependencies:
  - role: amtega.check_platform
    check_platform_distributions:
      centos: 6
      fedora: 27
      rhel: 6

  - role: amtega.environment
    environment_config:
      http_proxy: "{{ proxy_client_http_proxy }}"
      HTTP_PROXY: "{{ proxy_client_http_proxy }}"
    when:
      - proxy_client_permanent
      - proxy_client_http_proxy | default('') | length > 0

  - role: amtega.environment
    environment_config:
      https_proxy: "{{ proxy_client_https_proxy }}"
      HTTPS_PROXY: "{{ proxy_client_https_proxy }}"
    when:
      - proxy_client_permanent
      - proxy_client_https_proxy | default('') | length > 0

  - role: amtega.environment
    environment_config:
      no_proxy: "{{ proxy_client_no_proxy | join(',') }}"
      NO_PROXY: "{{ proxy_client_no_proxy | join(',') }}"
    when:
      - proxy_client_permanent
      - proxy_client_no_proxy | default('') | length > 0
